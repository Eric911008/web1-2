<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
    <title>Starter Template - Materialize</title>
    <!-- Compiled and minified CSS -->
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />

    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- CSS  -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link rel="stylesheet" href="flexslider.css" type="text/css">
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script> -->
    <script src="jquery.flexslider.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="js/materialize.js"></script>
    <script src="js/init.js"></script>
    <script crossorigin="anonymous">

        google.charts.load('current', { 'packages': ['corechart'] });

        // Set a callback to run when the Google Visualization API is loaded.	
        google.charts.setOnLoadCallback(init);

        function init() {
            var url =
                'https://docs.google.com/spreadsheets/d/1WhrxoOovFNi2tbAQkRQMu7Ac6gB6n8LXw618D1gkiJ0/gviz/tq?sheet=網頁資訊';

            var query = new google.visualization.Query(url);
            console.log(query)
            query.setQuery('select *');
            query.send(processSheetsData);
        }	
    </script>
</head>


<body>
    <nav class="brown" role="navigation">
        <div class="nav-wrapper container"><a id="logo-container" href="https://41100029026.netlify.app/" class="brand-logo">Blog</a>
            <ul class="right hide-on-med-and-down">
            </ul>

            <ul id="nav-mobile" class="sidenav">
            </ul>
            <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
        </div>
    </nav>
    <div class="section no-pad-bot" id="index-banner">
        <div class="container">
            <br><br>
            <h1 class="header center brown-text">台中精選飯店</h1>
            <br><br>

        </div>
    </div>




    <div class="row" id="loopTest">
    </div>

    <script>

        title = []
        booking = []
        start = []
        numbers = []
        years = []
        address = []
        embedurl = []
        img1 = []

        function processSheetsData(response) {
            console.log(response)
            var data = response.getDataTable();
            var columns = data.getNumberOfColumns();
            var rows = data.getNumberOfRows();
            console.log(rows)
            for (var r = 0; r < rows; r++) {
                console.log(data.getFormattedValue(r, 0))
                title[r] = data.getFormattedValue(r, 0);
                start[r] = data.getFormattedValue(r, 2);
                img1[r] = data.getFormattedValue(r, 7);
            }

            var text = "";
            for (i = 0; i < rows; i++) {
                text = text + '<div class="col s12 m4 l2">';
                text = text + '  <div class="card">';

                text = text + '    <div class="card-image">';
                text = text + '      <img src="' + img1[i] + '" width="100%" height="200">';

                text = text + '      <span class="card-title"></span>';
                text = text + '    </div>';

                text = text + '    <div class="card-content">';
                text = text + '      <p> ' + title[i] + ' </p>';
                text = text + '    </div>';

                text = text + '    <div class="card-action">';
                text = text + '      <a href="subpage.html?id=' + i + '">看介紹</a>';
                text = text + '    </div>';

                text = text + '  </div>';
                text = text + '</div>';
            }

            document.getElementById("loopTest").innerHTML = text;
            $('.flexslider').flexslider(
                {
                    slideshowSpeed: 3000,
                    animationSpeed: 500,
                    touch: true,
                    slideshow: true
                }
            );

        }
    </script>
    <footer class="page-footer orange lighten-1">
        <h4 class="white-text">延伸閱讀</h4>

        <head>
            <script>
                var xmlhttp = new XMLHttpRequest();
                var url = "https://emma.pixnet.cc/mainpage/blog/categories/hot/28?page=13&per_page=4&api_version=2&format=json";

                xmlhttp.onreadystatechange = function () {
                    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                        var myArr = JSON.parse(xmlhttp.responseText);
                        myFunction(myArr);
                    }
                }
                xmlhttp.open("GET", url, true);
                xmlhttp.send();

                function myFunction(arr) {
                    var data = arr.articles;
                    var out = "";
                    var i;
                    for (i = 0; i < data.length; i++) {
                        if (data[i].thumb != "") out += '<img src="' + data[i].thumb + '" />';
                        if (data[i].title != "") out += '<p><a href="' + data[i].link + '" target="_blank">' + data[i].title + '</a></p>';
                        if (data[i].address != undefined) out += '<p><a href="https://www.google.com.tw/maps?daddr=' + data[i].address + '" target="_blank">' + data[i].address + '</a></p>';
                        out += '<p> </p>';
                        out += '<br /><br /><br />';
                    }
                    document.getElementById("pixnet-stuff").innerHTML = out;
                }
            </script>
        </head>

        <body>
            <div id="pixnet-stuff">
            </div>
        </body>
    </footer>


    <!--  Scripts-->


</body>

</html>
